# Microsoft Outlook Failure Reports Configuration

# Azure AD / Entra ID Configuration
# Get these from Azure Portal > App registrations > Your app
OUTLOOK_TENANT_ID=your-tenant-id-here
OUTLOOK_CLIENT_ID=your-client-id-here
OUTLOOK_CLIENT_SECRET=your-client-secret-here

# Mailbox to Monitor
# Email address of the mailbox where failure reports are received
OUTLOOK_USER_EMAIL=notices@dcplibrary.org

# Graph API Version (usually don't need to change this)
OUTLOOK_API_VERSION=v1.0

# Email Filtering Options
# Folder to monitor (null for inbox, or specify folder name like "Failure Reports")
OUTLOOK_FOLDER=null

# Subject filter (partial match, case-insensitive)
# This will filter for emails containing "Undelivered" in the subject
OUTLOOK_SUBJECT_FILTER=Undelivered

# Sender email filters (comma-separated)
# Common postmaster and mailer-daemon addresses
OUTLOOK_FROM_FILTER=postmaster@,mailer-daemon@,noreply@shoutbomb.com

# Maximum number of emails to process per run
OUTLOOK_MAX_EMAILS=50

# Only process unread emails
OUTLOOK_UNREAD_ONLY=true

# Mark emails as read after processing
OUTLOOK_MARK_AS_READ=true

# Move processed emails to a folder (null to keep in place)
# Folder must exist in Outlook before using this
OUTLOOK_MOVE_TO_FOLDER=null

# Storage Configuration
# Database table name for storing failure reports
OUTLOOK_FAILURE_TABLE=notice_failure_reports

# Store raw email content for debugging (uses more disk space)
OUTLOOK_STORE_RAW=false

# Log each processed email to Laravel log
OUTLOOK_LOG_PROCESSING=true
